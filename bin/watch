#!/bin/bash

# `e` for exiting if any command fails, and `x` for outputting command
set -ex

echo "You'll need to re-run if you edit worker-message"
echo "Also, you'll need to make changes by hand assets/shared-worker/main.js everytime you make a change"
yarn run ng build worker-message
if [ -z ${@:1} ]; then
  OUTPUT_PATH='./dist/website-content' # TODO: May break if one makes an angular project called `website-content` xD
else
  OUTPUT_PATH=${@:1}
fi
concurrently --kill-others "yarn run ng build --watch --delete-output-path=false --output-path=$OUTPUT_PATH" "yarn run ng build shared-worker --watch --delete-output-path=false --output-path=$OUTPUT_PATH/assets/shared-worker"

# Example: yarn run watch ~/Sites/<website-name>
